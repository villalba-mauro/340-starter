<% if (title) { %>
<h1><%= title %></h1>

<!-- Flash message display area -->
<div class="pop-up"><%- messages() %></div>

<!-- Server-side errors display -->
<% if (errors) { %>
<ul class="notice">
  <% errors.array().forEach(error => { %>
  <li><%= error.msg %></li>
  <% }) %>
</ul>
<% } %>

<div class="favorites-container">
  <% if (favorites && favorites.length > 0) { %>
    <p>You have <%= favorites.length %> vehicle(s) in your favorites.</p>
    
    <div class="favorites-grid">
      <% favorites.forEach(function(vehicle) { %>
        <div class="favorite-item">
          <div class="favorite-image">
            <a href="/inv/detail/<%= vehicle.inv_id %>">
              <img src="<%= vehicle.inv_thumbnail %>" 
                   alt="<%= vehicle.inv_make %> <%= vehicle.inv_model %>" />
            </a>
          </div>
          
          <div class="favorite-details">
            <h3>
              <a href="/inv/detail/<%= vehicle.inv_id %>">
                <%= vehicle.inv_year %> <%= vehicle.inv_make %> <%= vehicle.inv_model %>
              </a>
            </h3>
            
            <p class="price">$<%= new Intl.NumberFormat('en-US').format(vehicle.inv_price) %></p>
            <p class="miles"><%= new Intl.NumberFormat('en-US').format(vehicle.inv_miles) %> miles</p>
            <p class="classification"><%= vehicle.classification_name %></p>
            <p class="date-added">Added: <%= new Date(vehicle.date_added).toLocaleDateString() %></p>
            
            <div class="favorite-actions">
              <a href="/inv/detail/<%= vehicle.inv_id %>" class="btn-view">View Details</a>
              <a href="/account/favorites/remove/<%= vehicle.inv_id %>?returnTo=/account/favorites" 
                 class="btn-remove" 
                 onclick="return confirm('Remove from favorites?')">Remove</a>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } else { %>
    <div class="empty-favorites">
      <h2>No Favorites Yet</h2>
      <p>You haven't added any vehicles to your favorites list.</p>
      <p><a href="/" class="btn-browse">Browse Vehicles</a></p>
    </div>
  <% } %>
  
  <div class="back-link">
    <a href="/account/">‚Üê Back to Account Management</a>
  </div>
</div>

<style>
.favorites-container {
  max-width: 1200px;
  margin: 20px auto;
  padding: 20px;
}

.favorites-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: 20px;
  margin-top: 20px;
}

.favorite-item {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  background-color: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.2s;
}

.favorite-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 8px rgba(0,0,0,0.15);
}

.favorite-image {
  text-align: center;
  margin-bottom: 15px;
}

.favorite-image img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
}

.favorite-details h3 {
  margin: 0 0 10px 0;
  color: #333;
}

.favorite-details h3 a {
  color: #007bff;
  text-decoration: none;
}

.favorite-details h3 a:hover {
  text-decoration: underline;
}

.price {
  font-size: 1.2em;
  font-weight: bold;
  color: #28a745;
  margin: 5px 0;
}

.miles, .classification, .date-added {
  margin: 5px 0;
  color: #666;
  font-size: 0.9em;
}

.favorite-actions {
  margin-top: 15px;
  /* display: flex; */
  gap: 10px;
}

.btn-view, .btn-remove, .btn-browse {
  padding: 8px 16px;
  text-decoration: none;
  border-radius: 4px;
  font-size: 0.9em;
  text-align: center;
  cursor: pointer;
  border: none;
  display: inline-block;
}

.btn-view, .btn-browse {
  background-color: #007bff;
  color: white;
}

.btn-view:hover, .btn-browse:hover {
  background-color: #0056b3;
  color: white;
  text-decoration: none;
}

.btn-remove {
  background-color: #dc3545;
  color: white;
}

.btn-remove:hover {
  background-color: #c82333;
  color: white;
  text-decoration: none;
}

.empty-favorites {
  text-align: center;
  padding: 40px;
  color: #666;
}

.empty-favorites h2 {
  color: #333;
  margin-bottom: 15px;
}

.back-link {
  text-align: center;
  margin-top: 30px;
}

.back-link a {
  color: #007bff;
  text-decoration: none;
  font-weight: bold;
}

.back-link a:hover {
  text-decoration: underline;
}
</style>

<% } else { res.redirect('/') } %>